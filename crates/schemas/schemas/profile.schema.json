{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://racing-wheel-suite.com/schemas/profile.v1.json",
  "title": "Racing Wheel Profile Schema",
  "description": "Schema for racing wheel configuration profiles",
  "type": "object",
  "required": ["schema", "scope", "base"],
  "properties": {
    "schema": {
      "type": "string",
      "const": "wheel.profile/1",
      "description": "Schema version identifier"
    },
    "scope": {
      "type": "object",
      "description": "Profile application scope",
      "properties": {
        "game": {
          "type": "string",
          "description": "Target game identifier"
        },
        "car": {
          "type": ["string", "null"],
          "description": "Specific car model (optional)"
        },
        "track": {
          "type": ["string", "null"],
          "description": "Specific track (optional)"
        }
      },
      "additionalProperties": false
    },
    "base": {
      "type": "object",
      "description": "Base configuration settings",
      "required": ["ffbGain", "dorDeg", "torqueCapNm", "filters"],
      "properties": {
        "ffbGain": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 2.0,
          "description": "Force feedback gain multiplier"
        },
        "dorDeg": {
          "type": "integer",
          "minimum": 90,
          "maximum": 1800,
          "description": "Degrees of rotation"
        },
        "torqueCapNm": {
          "type": "number",
          "minimum": 0.1,
          "maximum": 50.0,
          "description": "Maximum torque in Newton-meters"
        },
        "filters": {
          "type": "object",
          "description": "Force feedback filtering configuration",
          "required": [
            "reconstruction",
            "friction",
            "damper", 
            "inertia",
            "bumpstop",
            "handsOff",
            "torqueCap",
            "notchFilters",
            "slewRate",
            "curvePoints"
          ],
          "properties": {
            "reconstruction": {
              "type": "integer",
              "minimum": 1,
              "maximum": 8,
              "description": "Signal reconstruction filter level"
            },
            "friction": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Friction compensation level"
            },
            "damper": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Damper effect level"
            },
            "inertia": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Inertia compensation level"
            },
            "bumpstop": {
              "type": "object",
              "description": "Bumpstop configuration",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "strength": {
                  "type": "number",
                  "minimum": 0.0,
                  "maximum": 1.0,
                  "default": 0.5
                }
              },
              "additionalProperties": false
            },
            "handsOff": {
              "type": "object",
              "description": "Hands-off detection configuration",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "sensitivity": {
                  "type": "number",
                  "minimum": 0.0,
                  "maximum": 1.0,
                  "default": 0.3
                }
              },
              "additionalProperties": false
            },
            "torqueCap": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 50.0,
              "description": "Filter-specific torque cap in Newton-meters"
            },
            "notchFilters": {
              "type": "array",
              "description": "Notch filters for frequency-specific attenuation",
              "items": {
                "type": "object",
                "required": ["hz", "q", "gainDb"],
                "properties": {
                  "hz": {
                    "type": "number",
                    "minimum": 1.0,
                    "maximum": 500.0,
                    "description": "Center frequency in Hz"
                  },
                  "q": {
                    "type": "number",
                    "minimum": 0.1,
                    "maximum": 10.0,
                    "description": "Quality factor"
                  },
                  "gainDb": {
                    "type": "number",
                    "minimum": -60.0,
                    "maximum": 0.0,
                    "description": "Gain in decibels (negative for attenuation)"
                  }
                },
                "additionalProperties": false
              }
            },
            "slewRate": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 1.0,
              "description": "Slew rate limiting factor"
            },
            "curvePoints": {
              "type": "array",
              "description": "Force feedback response curve points",
              "minItems": 2,
              "items": {
                "type": "object",
                "required": ["input", "output"],
                "properties": {
                  "input": {
                    "type": "number",
                    "minimum": 0.0,
                    "maximum": 1.0,
                    "description": "Input force level (0.0-1.0)"
                  },
                  "output": {
                    "type": "number",
                    "minimum": 0.0,
                    "maximum": 1.0,
                    "description": "Output force level (0.0-1.0)"
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "leds": {
      "type": ["object", "null"],
      "description": "LED configuration (optional)",
      "properties": {
        "rpmBands": {
          "type": "array",
          "description": "RPM thresholds for LED bands",
          "items": {
            "type": "number",
            "minimum": 0
          }
        },
        "pattern": {
          "type": "string",
          "description": "LED pattern identifier"
        },
        "brightness": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "LED brightness level"
        },
        "colors": {
          "type": "object",
          "description": "Color mappings",
          "patternProperties": {
            ".*": {
              "type": "array",
              "items": {
                "type": "integer",
                "minimum": 0,
                "maximum": 255
              },
              "minItems": 3,
              "maxItems": 3,
              "description": "RGB color values"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "haptics": {
      "type": ["object", "null"],
      "description": "Haptic feedback configuration (optional)",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable haptic feedback"
        },
        "intensity": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Haptic intensity level"
        },
        "frequencyHz": {
          "type": "number",
          "minimum": 1.0,
          "maximum": 1000.0,
          "description": "Haptic frequency in Hz"
        },
        "effects": {
          "type": "object",
          "description": "Effect-specific settings",
          "patternProperties": {
            ".*": {
              "type": "boolean",
              "description": "Enable/disable specific effect"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "signature": {
      "type": ["string", "null"],
      "description": "Profile signature for integrity verification (optional)"
    }
  },
  "additionalProperties": false
}